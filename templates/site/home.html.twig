
{% extends 'base.html.twig' %}

{% block stylesheets %}
  {{parent()}}
  <link rel="stylesheet" href="{{asset('css/home.css')}}">
{% endblock %}
{% block body %}

<!-- JUMBOTORN -->

 <div class="jumbotron jumbotron-fluid" style=""=>

{# <video autoplay muted loop>    
    <source src="" data-src="{{asset('videos/paris.mp4')}}" type="video/mp4">
</video> #}

  {# <div class="container-fluid haut"> #}
    <div class="row" style="height:100%; display:flex;">
      <div class="col-md-4 offset-md-2 haut-gauche" style="text-align:center;">
        <p style="font-family: 'Roboto Condensed', sans-serif;">LES <br> DERNIERS <br> BONS <br> PLANS !</p>
        <a href="#last_articles"><p class='icon-scroll'></p></a>
      </div>
      <div class="col-md-6 haut-gauche">
        <p style="font-family: 'Roboto Condensed', sans-serif;">Inscris-toi pour créer ta liste de bons plans préférés !</br>
        <a href="{{ path('app_register')}}"><button type="button" class="btn btn-lg">S'inscrire</button></a></p>
      </div>
    </div>
  {# </div> #}
  <!-- /.container -->
</div>


<!-- JUMBOTORN END -->


<!-- TOP ARTICLES -->

{{ dump(user_articles_ids)}}

<div class="container container-top" id="last_articles">
  <div class="row tops">

    <!-- TOP RESTO -->
    <div class="col-md-4 topresto">
    <div style="background-color:#e3e7ea; padding-bottom:20px;">
      <h2><span>RESTOS</span></h2>
      {% for resto in restos %}
      <a href="{{ path('article_show', {'id': resto.id }) }}">
        <div class="card shadow p-3 mb-5 bg-white rounded" >
          <img class="card-img-top img-thumbnail" src="{{ asset('images/articles/'~ resto.image)}}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">{{resto.name}}</h5>
            <p class="card-text price">~{{resto.price}}€</p>
            {% if (resto.id in user_articles_ids) == false and is_granted('ROLE_USER') %}
            <a href="{{ path('add_to_list', {'id': resto.id })}}" class="add-to-list"><button class="btn btn-sm btn-add">AJOUTER</button></a>
            {% elseif is_granted('ROLE_USER') %}
            <button class="btn btn-sm btn-saved">AJOUTÉ</button>
            {% endif %}
            <span class="card-text" style="font-style:italic; color:grey; float:left;">{{resto.createdAt|date("d/m/Y")}}</span>
          </div>
        </div>
      </a>

      {% endfor %}
    </div>
    <div style="text-align:center; padding-top:20px">
        <a href="{{ path('resto')}}"><button type="button" class="btn btn-lg full-list">TOUS LES RESTOS</button></a>
      </div>
    </div>

    <!-- TOP BISTRO -->
    <div class="col-md-4 topbistro">
      <div style="background-color:#e3e7ea; padding-bottom:20px;">
        <h2><span>BISTROS</span></h2>
        {% for bistro in bistros %}
        <a href="{{ path('article_show', {'id': bistro.id }) }}">
          <div class="card shadow p-3 mb-5 bg-white rounded" >
            <img class="card-img-top img-thumbnail" src="{{ asset('images/articles/'~ bistro.image)}}" alt="Card image cap">
            <div class="card-body">
              <h5 class="card-title">{{bistro.name}}</h5>
              <p class="card-text price">~{{bistro.price}}€</p>
              {% if (bistro.id in user_articles_ids) == false and is_granted('ROLE_USER')%}
            <a href="{{ path('add_to_list', {'id': bistro.id })}}" class="add-to-list"><button class="btn btn-sm btn-add">AJOUTER</button></a>
            {% elseif is_granted('ROLE_USER') %}
            <button class="btn btn-sm btn-saved">AJOUTÉ</button>
            {% endif %}
              <span class="card-text" style="font-style:italic; color:grey; float:left;">{{bistro.createdAt|date("d/m/Y")}}</span>
            </div>
          </div>
        </a>
        {% endfor %}
      </div>
      <div style="text-align:center; padding-top:20px">
        <a href="{{ path('expo')}}"><button type="button" class="btn btn-lg full-list">TOUTES LES BISTROS</button></a>
      </div>
    </div>

    <!-- TOP EXPO -->
    <div class="col-md-4 topexpo">
    <div style="background-color:#e3e7ea; padding-bottom:20px;">
      <h2><span>EXPOS</span></h2>
      {% for expo in expos %}
      <a href="{{ path('article_show', {'id': expo.id }) }}">
        <div class="card shadow p-3 mb-5 bg-white roundedS" >
          <img class="card-img-top img-thumbnail" src="{{ asset('images/articles/'~ expo.image)}}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">{{expo.name}}</h5>
            {% if expo.price > 0 %}
            <p class="card-text price">~{{expo.price}}€</p>
            {% else %}
            <p class="card-text price">GRATUIT</p>
            {% endif %}
            {% if (expo.id in user_articles_ids) == false and is_granted('ROLE_USER') %}
            <a href="{{ path('add_to_list', {'id': expo.id })}}" class="add-to-list"><button class="btn btn-sm btn-add">AJOUTER</button></a>
            {% elseif is_granted('ROLE_USER') %}
            <button class="btn btn-sm btn-saved">AJOUTÉ</button>
            {% endif %}
            <span class="card-text" style="font-style:italic; color:grey; float:left;">{{expo.createdAt|date("d/m/Y")}}</span>
          </div>
        </div>
      </a>
      {% endfor %}
    </div>
    <div style="text-align:center; padding-top:20px">
        <a href="{{ path('expo')}}"><button type="button" class="btn btn-lg full-list">TOUTES LES EXPOS</button></a>
      </div>
    </div>

    

    


  </div>
</div>
<!-- TOP ARTICLES END -->


{% endblock %}

{% block javascripts %}
{{parent()}}
<script>
$(document).ready(function () { 
  $('body').hide().fadeIn(1500).delay(6000);
});


{# document.getElementsByClassName('.jumbotron').onscroll = function(){
  location.hash = "#last_articles";
} #}


</script>
{# AJAX CALL FOR ADDING ARTICLE TO USER VIA AXIOS #}
<script>
  function onClickBtnAddList(event){
    event.preventDefault();

    const btnAdd = this.querySelector('.btn-add');
    const url = this.href;
    axios.get(url).then(function(response) {
      btnAdd.textContent = "AJOUTÉ";
      btnAdd.classList.remove("btn-add");
      btnAdd.classList.add("btn-saved");
      
      

    })
  }
  document.querySelectorAll('.add-to-list').forEach(function(link){
    link.addEventListener('click', onClickBtnAddList);
  })
</script>
{% endblock %}

